function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper")}FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},FrontBase.prototype.Run=function(){this.listenAuthBoxHover()},$(function(){(new FrontBase).Run()}),$(function(){$(".switch").click(function(){var t=$(".scroll-wrapper");parseInt(t.css("left"))<0?t.animate({left:"0"}):t.animate({left:"-400px"})})}),Auth.prototype.run=function(){var t=this;t.listenShowhideEvent(),t.listenSignInEvent(),t.ListCaptchaClick(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.ListCaptchaClick=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random"+Math.random())})},Auth.prototype.listenShowhideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn"),o=$(".scroll-wrapper");n.click(function(){t.showEvent(),o.css({left:0})}),e.click(function(){t.showEvent(),o.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.SmsSuccessEvent=function(){var t=this,n=$(".sms-captcha-addon");messageBox.showSuccess("短信验证码发送成功"),n.addClass("disabled");var e=60;n.unbind("click");var a=setInterval(function(){n.text(e+"s"),--e<=0&&(clearInterval(a),n.removeClass("disabled"),n.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){t.preventDefault();var n=f.find("input[name='telephone']"),e=f.find("input[name='username']"),a=f.find("input[name='img_captcha']"),o=f.find("input[name='password1']"),s=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),u=a.val(),p=o.val(),l=s.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:u,password1:p,password2:l,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-addon"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.SmsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignInEvent=function(){var o=this,t=$(".signin-group"),a=t.find("input[name='telephone']"),s=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=a.val(),n=s.val(),e=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){if(200==t.code)o.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var a=n[e][0];window.messageBox.show(a)}}},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/60/60),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJwcm90b3R5cGUiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwiUnVuIiwiY2xpY2siLCJzY3JvbGxXcmFwcGVyIiwicGFyc2VJbnQiLCJjc3MiLCJhbmltYXRlIiwibGVmdCIsInJ1biIsInNlbGYiLCJsaXN0ZW5TaG93aGlkZUV2ZW50IiwibGlzdGVuU2lnbkluRXZlbnQiLCJMaXN0Q2FwdGNoYUNsaWNrIiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJpbWciLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiU21zU3VjY2Vzc0V2ZW50Iiwic21zQ2FwdGNoYSIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwic2lnbnVwR3JvdXAiLCJmaW5kIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRlbGVwaG9uZUlucHV0IiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJ1c2VybmFtZSIsImltZ19jYXB0Y2hhIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwic21zX2NhcHRjaGEiLCJ4ZnphamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJ0ZWxlUGhvbmVJbnB1dCIsInRlbGUiLCJzaG93SW5mbyIsImdldCIsImZhaWwiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJzaWduaW5ncm91cCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJ0ZWwiLCJwd2QiLCJyZW0iLCJwcm9wIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwia2V5IiwibWVzc2FnZSIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGFBMkNULFNBQVNDLE9BQ01DLEtBQ05DLFlBQWNDLEVBQUUsaUJBekN6QkosVUFBVUssVUFBVUMsbUJBQW1CLFdBQ25DLElBQUlDLEVBQVVILEVBQUUsYUFDWkksRUFBY0osRUFBRSxrQkFDcEJHLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDZCxXQUNFRixFQUFZRyxVQUtwQlgsVUFBVUssVUFBVU8sSUFBTSxXQUNiVixLQUNOSSxzQkFHUEYsRUFBRSxZQUNhLElBQUlKLFdBQ1ZZLFFBS1RSLEVBQUUsV0FDQ0EsRUFBRSxXQUFXUyxNQUFNLFdBQ2QsSUFBSUMsRUFBY1YsRUFBRSxtQkFDRlcsU0FBU0QsRUFBY0UsSUFBSSxTQUM5QixFQUVYRixFQUFjRyxRQUFRLENBQUNDLEtBQU8sTUFJOUJKLEVBQWNHLFFBQVEsQ0FBQ0MsS0FBTyxlQVcxQ2pCLEtBQUtJLFVBQVVjLElBQUksV0FDZixJQUFJQyxFQUFNbEIsS0FDVmtCLEVBQUtDLHNCQUNMRCxFQUFLRSxvQkFDTEYsRUFBS0csbUJBQ0xILEVBQUtJLHdCQUNMSixFQUFLSyxxQkFHVHhCLEtBQUtJLFVBQVVxQixVQUFVLFdBQ1h4QixLQUNMQyxZQUFZ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e1xuXG59XG5cbkZyb250QmFzZS5wcm90b3R5cGUubGlzdGVuQXV0aEJveEhvdmVyPWZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXV0aEJveCA9ICQoJy5hdXRoLWJveCcpO1xuICAgIHZhciB1c2VyTW9yZUJveCA9ICQoJy51c2VyLW1vcmUtYm94Jyk7XG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKVxuICAgIH0sZnVuY3Rpb24gKCkge1xuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKClcbiAgICB9KVxufTtcblxuXG5Gcm9udEJhc2UucHJvdG90eXBlLlJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICBzZWxmLmxpc3RlbkF1dGhCb3hIb3ZlcigpO1xufTtcblxuJChmdW5jdGlvbiAoKSB7XG4gICB2YXIgZmJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XG4gICBmYmFzZS5SdW4oKTtcbn0pO1xuXG5cblxuJChmdW5jdGlvbiAoKSB7XG4gICAkKCcuc3dpdGNoJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2Nyb2xsV3JhcHBlcj0kKCcuc2Nyb2xsLXdyYXBwZXInKTtcbiAgICAgICAgdmFyIGN1cnJlbnRsZWZ0ID0gcGFyc2VJbnQoc2Nyb2xsV3JhcHBlci5jc3MoJ2xlZnQnKSk7XG4gICAgICAgIGlmKGN1cnJlbnRsZWZ0PDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7J2xlZnQnOicwJ30pXG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBzY3JvbGxXcmFwcGVyLmFuaW1hdGUoeydsZWZ0JzonLTQwMHB4J30pXG4gICAgICAgIH1cbiAgIH0pXG59KTtcblxuXG5mdW5jdGlvbiBBdXRoKCkge1xuICAgIHZhciAgc2VsZiA9dGhpcztcbiAgICBzZWxmLm1hc2tXcmFwcGVyID0gJCgnLm1hc2std3JhcHBlcicpXG59XG5cbkF1dGgucHJvdG90eXBlLnJ1bj1mdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID10aGlzO1xuICAgIHNlbGYubGlzdGVuU2hvd2hpZGVFdmVudCgpO1xuICAgIHNlbGYubGlzdGVuU2lnbkluRXZlbnQoKTtcbiAgICBzZWxmLkxpc3RDYXB0Y2hhQ2xpY2soKTtcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xuICAgIHNlbGYubGlzdGVuU2lnbnVwRXZlbnQoKTtcbn07XG5cbkF1dGgucHJvdG90eXBlLnNob3dFdmVudD1mdW5jdGlvbigpIHtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICBzZWxmLm1hc2tXcmFwcGVyLnNob3coKTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmhpZGVFdmVudCA9IGZ1bmN0aW9uKCl7XG4gIHZhciBzZWxmID10aGlzO1xuICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKVxufTtcblxuXG5BdXRoLnByb3RvdHlwZS5MaXN0Q2FwdGNoYUNsaWNrPWZ1bmN0aW9uKCl7XG4gICAgdmFyIGltZyA9JCgnLmltZy1jYXB0Y2hhJyk7XG4gICAgaW1nLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW1nLmF0dHIoJ3NyYycsJy9hY2NvdW50L2ltZ19jYXB0Y2hhLycrJz9yYW5kb20nK01hdGgucmFuZG9tKCkpXG4gICAgfSk7XG59O1xuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaG93aGlkZUV2ZW50ID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB2YXIgc2lnbmluQnRuPSQoJy5zaWduaW4tYnRuJyk7XG4gICAgdmFyIHNpZ251cEJ0bj0kKCcuc2lnbnVwLWJ0bicpO1xuICAgIHZhciBjbG9zZUJ0bj0kKCcuY2xvc2UtYnRuJyk7XG4gICAgdmFyIHNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xuICAgICAgICBzY3JvbGxXcmFwcGVyLmNzcyh7J2xlZnQnOjB9KTtcbiAgICB9KTtcblxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XG4gICAgICAgIHNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6LTQwMH0pXG4gICAgfSk7XG5cbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcbiAgICB9KTtcblxufTtcblxuLy/nn63kv6Hpqozor4HnoIHlj5HpgIHmiJDlip/nmoTkuovku7ZcbkF1dGgucHJvdG90eXBlLlNtc1N1Y2Nlc3NFdmVudCA9ZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB2YXIgc21zQ2FwdGNoYT0gJCgnLnNtcy1jYXB0Y2hhLWFkZG9uJyk7XG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuefreS/oemqjOivgeeggeWPkemAgeaIkOWKn1wiKTtcbiAgICBzbXNDYXB0Y2hhLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgIHZhciBjb3VudD02MDtcbiAgICBzbXNDYXB0Y2hhLnVuYmluZCgnY2xpY2snKTtcbiAgICB2YXIgdGltZSA9c2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICBzbXNDYXB0Y2hhLnRleHQoY291bnQrJ3MnKTtcbiAgICAgICAgY291bnQtLTtcbiAgICAgICAgaWYoY291bnQ8PTApe1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lKTtcbiAgICAgICAgICAgIHNtc0NhcHRjaGEucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICBzbXNDYXB0Y2hhLnRleHQoJ+WPkemAgemqjOivgeeggScpO1xuICAgICAgICAgICAgc2VsZi5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQoKTtcbiAgICAgICAgfVxuICAgICAgICB9LDEwMDApO1xufTtcblxuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TaWdudXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2lnbnVwR3JvdXAgPSAkKCcuc2lnbnVwLWdyb3VwJyk7XG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNpZ251cEdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgdGVsZXBob25lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XG4gICAgICAgIHZhciB1c2VybmFtZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3VzZXJuYW1lJ11cIik7XG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0naW1nX2NhcHRjaGEnXVwiKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xuICAgICAgICB2YXIgcGFzc3dvcmQySW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQyJ11cIik7XG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0nc21zX2NhcHRjaGEnXVwiKTtcblxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciB1c2VybmFtZSA9IHVzZXJuYW1lSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBpbWdfY2FwdGNoYSA9IGltZ0NhcHRjaGFJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQyID0gcGFzc3dvcmQySW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBzbXNfY2FwdGNoYSA9IHNtc0NhcHRjaGFJbnB1dC52YWwoKTtcblxuICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxuICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZDInOiBwYXNzd29yZDIsXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG4vL+ebkeWQrOWPkemAgeefreS/oemqjOivgeeggeeahOS6i+S7tlxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50PWZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPXRoaXM7XG4gICAgdmFyIHNtc0NhcHRjaGE9ICQoJy5zbXMtY2FwdGNoYS1hZGRvbicpO1xuICAgIHZhciB0ZWxlUGhvbmVJbnB1dCA9ICQoXCIuc2lnbnVwLWdyb3VwIGlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xuICAgIHNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGVsZSA9dGVsZVBob25lSW5wdXQudmFsKCk7XG4gICAgICAgIGlmKCF0ZWxlKXtcbiAgICAgICAgICAgIG1lc3NhZ2VCb3guc2hvd0luZm8oJ+ivt+i+k+WFpeaJi+acuuWPt+eggScpXG4gICAgICAgIH1cbiAgICAgICAgeGZ6YWpheC5nZXQoe1xuICAgICAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvc21zX2NhcHRjaGEvJyxcbiAgICAgICAgICAgICAgICAnZGF0YSc6e1xuICAgICAgICAgICAgICAgICAgICAndGVsZXBob25lJzp0ZWxlXG4gICAgICAgICAgICAgICAgfSAsXG4gICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ109PTIwMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLlNtc1N1Y2Nlc3NFdmVudCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdmYWlsJzpmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfSk7XG59O1xuXG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ25JbkV2ZW50PWZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPXRoaXM7XG4gICAgdmFyIHNpZ25pbmdyb3VwID0gJCgnLnNpZ25pbi1ncm91cCcpO1xuICAgIHZhciB0ZWxlcGhvbmUgPSBzaWduaW5ncm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XG4gICAgdmFyIHBhc3N3b3JkID0gc2lnbmluZ3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkJ11cIik7XG4gICAgdmFyIHJlbWVtYmVyID0gc2lnbmluZ3JvdXAuZmluZChcImlucHV0W25hbWU9J3JlbWVtYmVyJ11cIik7XG5cbiAgICB2YXIgc3VibWl0QnRuPSBzaWduaW5ncm91cC5maW5kKFwiLnN1Ym1pdC1idG5cIik7XG5cbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGVsID0gdGVsZXBob25lLnZhbCgpO1xuICAgICAgICB2YXIgcHdkID1wYXNzd29yZC52YWwoKTtcbiAgICAgICAgdmFyIHJlbSA9IHJlbWVtYmVyLnByb3AoJ2NoZWNrZWQnKTtcblxuICAgICAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcbiAgICAgICAgICAgICdkYXRhJzoge1xuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWwsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcHdkLFxuICAgICAgICAgICAgICAgICdyZW1lbWJlcic6IHJlbT8xOjAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xuICAgICAgICAgICAgICAgICAgICAgaWYodHlwZW9mIG1lc3NhZ2VPYmplY3QgPT0gJ3N0cmluZycgfHwgbWVzc2FnZU9iamVjdC5jb25zdHJ1Y3RvciA9PSBTdHJpbmcpe1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0KTtcbiAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8ge1wicGFzc3dvcmRcIjpbJ+WvhueggeacgOWkp+mVv+W6puS4jeiDvei2hei/hzIw5Li677yBJywneHh4J10sXCJ0ZWxlcGhvbmVcIjpbJ3h4JywneCddfVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrZXkgaW4gbWVzc2FnZU9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9iamVjdFtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pXG59O1xuXG5cbiQoZnVuY3Rpb24gKCkge1xuICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xuICAgYXV0aC5ydW4oKTtcbn0pO1xuXG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIGlmKHdpbmRvdy50ZW1wbGF0ZSl7XG4gICAgICAgIHRlbXBsYXRlLmRlZmF1bHRzLmltcG9ydHMudGltZVNpbmNlID0gZnVuY3Rpb24gKGRhdGVWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShkYXRlVmFsdWUpO1xuICAgICAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpOyAvLyDlvpfliLDnmoTmmK/mr6vnp5LnmoRcbiAgICAgICAgICAgIHZhciBub3d0cyA9IChuZXcgRGF0ZSgpKS5nZXRUaW1lKCk7IC8v5b6X5Yiw55qE5piv5b2T5YmN5pe26Ze055qE5pe26Ze05oizXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKS8xMDAwOyAvLyDpmaTku6UxMDAw77yM5b6X5Yiw55qE5piv56eSXG4gICAgICAgICAgICBpZih0aW1lc3RhbXAgPCA2MCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAn5Yia5YiaJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKSB7XG4gICAgICAgICAgICAgICAgbWludXRlcyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcysn5YiG6ZKf5YmNJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGltZXN0YW1wID49IDYwKjYwICYmIHRpbWVzdGFtcCA8IDYwKjYwKjI0KSB7XG4gICAgICAgICAgICAgICAgaG91cnMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91cnMrJ+Wwj+aXtuWJjSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCoyNCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCozMCkge1xuICAgICAgICAgICAgICAgIGRheXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCAvIDYwIC8gMjQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBkYXlzICsgJ+WkqeWJjSc7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF5KCk7XG4gICAgICAgICAgICAgICAgdmFyIGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1pbnV0ZSA9IGRhdGUuZ2V0TWludXRlcygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB5ZWFyKycvJyttb250aCsnLycrZGF5K1wiIFwiK2hvdXIrXCI6XCIrbWludXRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSk7Il19
