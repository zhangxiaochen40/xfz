function Banners(){}Banners.prototype.LoadData=function(){var s=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var a=n.data,e=0;e<a.length;e++){var t=a[e],r=template("banner-item",{banner:t}),i=$(".banner-list-group");i.append(r);var o=i.find(".banner-item:last");s.addImageSelectEvent(o),s.addRemoveBtn(o),s.saveBannerEvent(o)}else console.log("cuowu")}})},Banners.prototype.listenBannersAddBtn=function(){var t=this;$("#banner-add-btn").click(function(){var n=template("banner-item"),a=$(".banner-list-group");a.prepend(n);var e=a.find(".banner-item:first");t.addImageSelectEvent(e),t.addRemoveBtn(e),t.saveBannerEvent(e)})},Banners.prototype.saveBannerEvent=function(t){var n=t.find(".btn-save"),r=t.find("input[name='priority']"),i=t.find("input[name='link_to']"),o=t.find(".thumbnail"),s=t.attr("data-banner-id"),c="";c=s?"/cms/edit_banner/":"/cms/add_banner/",n.click(function(){var n=o.attr("src"),a=r.val(),e=i.val();xfzajax.post({url:c,data:{img_url:n,priority:a,link_to:e},success:function(n){200===n.code&&(s=n.data.banner_id,t.attr("data-banner-id",s),window.messageBox.showSuccess("轮播图添加完成！"))}})})},Banners.prototype.addImageSelectEvent=function(n){var e=n.find(".thumbnail"),a=n.find(".image-input");e.click(function(){a.click()}),a.change(function(){var n=this.files[0],a=new FormData;a.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:a,processData:!1,contentType:!1,success:function(n){if(200===n.code){var a=n.data.url;e.attr("src",a)}}})})},Banners.prototype.addRemoveBtn=function(a){var n=a.find(".btn-close"),e=a.attr("data-banner-id");n.click(function(){e?xfzalert.alertConfirm({text:"确定要删除吗",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:e},success:function(n){200===n.code&&(a.remove(),window.messageBox.showSuccess("轮播图删除成功"))}})}}):a.remove()})},Banners.prototype.Run=function(){this.listenBannersAddBtn(),this.LoadData()},$(function(){(new Banners).Run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsIkxvYWREYXRhIiwic2VsZiIsInRoaXMiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImJhbm5lcnMiLCJpIiwibGVuZ3RoIiwiYmFubmVyIiwidHBsIiwidGVtcGxhdGUiLCJiYW5uZXJHcm91cCIsIiQiLCJhcHBlbmQiLCJiYW5uZXJJdGVtIiwiZmluZCIsImFkZEltYWdlU2VsZWN0RXZlbnQiLCJhZGRSZW1vdmVCdG4iLCJzYXZlQmFubmVyRXZlbnQiLCJjb25zb2xlIiwibG9nIiwibGlzdGVuQmFubmVyc0FkZEJ0biIsImNsaWNrIiwicHJlcGVuZCIsInNhdmVCdG4iLCJwcmlvcml0eVRhZyIsImxpbmtfdG9UYWciLCJpbWFnZVRhZyIsImJhbm5lcklkIiwiYXR0ciIsImltZ191cmwiLCJwcmlvcml0eSIsInZhbCIsImxpbmtfdG8iLCJwb3N0IiwiZGF0YSIsIndpbmRvdyIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImltYWdlIiwiaW1hZ2VJbnB1dCIsImNoYW5nZSIsImZpbGUiLCJmaWxlcyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwicmVtb3ZlQnRuIiwieGZ6YWxlcnQiLCJhbGVydENvbmZpcm0iLCJ0ZXh0IiwiY29uZmlybUNhbGxiYWNrIiwiYmFubmVyX2lkIiwicmVtb3ZlIiwiUnVuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxXQUtUQSxRQUFRQyxVQUFVQyxTQUFXLFdBQ3pCLElBQUlDLEVBQU1DLEtBQ1ZDLFFBQVFDLElBQUksQ0FDUkMsSUFBTSxvQkFDTkMsUUFBVSxTQUFVQyxHQUNoQixHQUFvQixNQUFqQkEsRUFBYSxLQUVaLElBREQsSUFBSUMsRUFBVUQsRUFBYSxLQUNqQkUsRUFBRSxFQUFFQSxFQUFFRCxFQUFRRSxPQUFPRCxJQUFJLENBQzlCLElBQUlFLEVBQVNILEVBQVFDLEdBQ2pCRyxFQUFNQyxTQUFTLGNBQWMsQ0FBQ0YsT0FBU0EsSUFDdkNHLEVBQVlDLEVBQUUsc0JBQ2xCRCxFQUFZRSxPQUFPSixHQUVuQixJQUFJSyxFQUFhSCxFQUFZSSxLQUFLLHFCQUVsQ2pCLEVBQUtrQixvQkFBb0JGLEdBQ3pCaEIsRUFBS21CLGFBQWFILEdBQ2xCaEIsRUFBS29CLGdCQUFnQkosUUFJekJLLFFBQVFDLElBQUksYUFPNUJ6QixRQUFRQyxVQUFVeUIsb0JBQXFCLFdBQ25DLElBQUl2QixFQUFPQyxLQUNJYSxFQUFFLG1CQUNQVSxNQUFNLFdBQ1osSUFBSWIsRUFBS0MsU0FBUyxlQUNkQyxFQUFZQyxFQUFFLHNCQUNsQkQsRUFBWVksUUFBUWQsR0FFcEIsSUFBSUssRUFBYUgsRUFBWUksS0FBSyxzQkFFbENqQixFQUFLa0Isb0JBQW9CRixHQUN6QmhCLEVBQUttQixhQUFhSCxHQUNsQmhCLEVBQUtvQixnQkFBZ0JKLE1BSzdCbkIsUUFBUUMsVUFBVXNCLGdCQUFrQixTQUFTSixHQUN6QyxJQUFJVSxFQUFVVixFQUFXQyxLQUFLLGFBQzFCVSxFQUFjWCxFQUFXQyxLQUFLLDBCQUM5QlcsRUFBYVosRUFBV0MsS0FBSyx5QkFDN0JZLEVBQVdiLEVBQVdDLEtBQUssY0FDM0JhLEVBQVdkLEVBQVdlLEtBQUssa0JBQzNCM0IsRUFBSSxHQUVKQSxFQUREMEIsRUFDSyxvQkFFQSxtQkFHUkosRUFBUUYsTUFBTSxXQUNWLElBQUlRLEVBQVVILEVBQVNFLEtBQUssT0FDeEJFLEVBQVdOLEVBQVlPLE1BQ3ZCQyxFQUFVUCxFQUFXTSxNQUN6QmhDLFFBQVFrQyxLQUFLLENBQ1RoQyxJQUFNQSxFQUNOaUMsS0FBTyxDQUNITCxRQUFVQSxFQUNWQyxTQUFXQSxFQUNYRSxRQUFVQSxHQUVkOUIsUUFBVSxTQUFVQyxHQUNJLE1BQWpCQSxFQUFhLE9BQ1p3QixFQUFXeEIsRUFBYSxLQUFhLFVBQ2pDVSxFQUFXZSxLQUFLLGlCQUFpQkQsR0FDakNRLE9BQU9DLFdBQVdDLFlBQVksbUJBUXREM0MsUUFBUUMsVUFBVW9CLG9CQUFzQixTQUFVRixHQUM5QyxJQUFJeUIsRUFBUXpCLEVBQVdDLEtBQUssY0FDeEJ5QixFQUFhMUIsRUFBV0MsS0FBSyxnQkFFakN3QixFQUFNakIsTUFBTSxXQUNSa0IsRUFBV2xCLFVBR2ZrQixFQUFXQyxPQUFPLFdBQ2QsSUFBSUMsRUFBTzNDLEtBQUs0QyxNQUFNLEdBQ2xCQyxFQUFXLElBQUlDLFNBQ25CRCxFQUFTL0IsT0FBTyxPQUFPNkIsR0FDdkIxQyxRQUFRa0MsS0FBSyxDQUNUaEMsSUFBTyxvQkFDUGlDLEtBQVFTLEVBQ1JFLGFBQWUsRUFDZkMsYUFBZSxFQUNmNUMsUUFBVyxTQUFVQyxHQUNqQixHQUFzQixNQUFuQkEsRUFBYSxLQUFVLENBQ3RCLElBQUlGLEVBQU1FLEVBQWEsS0FBTyxJQUM5Qm1DLEVBQU1WLEtBQUssTUFBTTNCLFVBUXJDUCxRQUFRQyxVQUFVcUIsYUFBZSxTQUFTSCxHQUN0QyxJQUFJa0MsRUFBWWxDLEVBQVdDLEtBQUssY0FDNUJhLEVBQVdkLEVBQVdlLEtBQUssa0JBQy9CbUIsRUFBVTFCLE1BQU0sV0FDVE0sRUFFQ3FCLFNBQVNDLGFBQWEsQ0FDbEJDLEtBQU8sU0FDUEMsZ0JBQWtCLFdBQ2RwRCxRQUFRa0MsS0FBSyxDQUNUaEMsSUFBTSxzQkFDTmlDLEtBQU8sQ0FDSGtCLFVBQVl6QixHQUVoQnpCLFFBQVUsU0FBVUMsR0FDSSxNQUFqQkEsRUFBYSxPQUNaVSxFQUFXd0MsU0FDWGxCLE9BQU9DLFdBQVdDLFlBQVksa0JBU2xEeEIsRUFBV3dDLFlBTXZCM0QsUUFBUUMsVUFBVTJELElBQUssV0FDVHhELEtBQ0xzQixzQkFES3RCLEtBRUxGLFlBR1RlLEVBQUUsWUFDZSxJQUFJakIsU0FDVDREIiwiZmlsZSI6ImJhbm5lcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQmFubmVycygpIHtcblxufVxuXG5cbkJhbm5lcnMucHJvdG90eXBlLkxvYWREYXRhID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB4ZnphamF4LmdldCh7XG4gICAgICAgICd1cmwnOicvY21zL2Jhbm5lcl9saXN0LycsXG4gICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXT09PTIwMCl7XG4gICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDtpPGJhbm5lcnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXIgPSBiYW5uZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoJ2Jhbm5lci1pdGVtJyx7J2Jhbm5lcic6YmFubmVyfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXJHcm91cD0kKCcuYmFubmVyLWxpc3QtZ3JvdXAnKTtcbiAgICAgICAgICAgICAgICAgICAgYmFubmVyR3JvdXAuYXBwZW5kKHRwbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lckl0ZW0gPSBiYW5uZXJHcm91cC5maW5kKCcuYmFubmVyLWl0ZW06bGFzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRSZW1vdmVCdG4oYmFubmVySXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1lbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2N1b3d1JylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5cbkJhbm5lcnMucHJvdG90eXBlLmxpc3RlbkJhbm5lcnNBZGRCdG4gPWZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBiYW5uZXJCdG4gPSQoJyNiYW5uZXItYWRkLWJ0bicpO1xuICAgIGJhbm5lckJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0cGwgPXRlbXBsYXRlKCdiYW5uZXItaXRlbScpO1xuICAgICAgICB2YXIgYmFubmVyR3JvdXA9JCgnLmJhbm5lci1saXN0LWdyb3VwJyk7XG4gICAgICAgIGJhbm5lckdyb3VwLnByZXBlbmQodHBsKTtcblxuICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lckdyb3VwLmZpbmQoJy5iYW5uZXItaXRlbTpmaXJzdCcpO1xuXG4gICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICAgICAgc2VsZi5hZGRSZW1vdmVCdG4oYmFubmVySXRlbSk7XG4gICAgICAgIHNlbGYuc2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xuICAgIH0pXG59O1xuXG5cbkJhbm5lcnMucHJvdG90eXBlLnNhdmVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xuICAgIHZhciBzYXZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuYnRuLXNhdmUnKTtcbiAgICB2YXIgcHJpb3JpdHlUYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdwcmlvcml0eSddXCIpO1xuICAgIHZhciBsaW5rX3RvVGFnID0gYmFubmVySXRlbS5maW5kKChcImlucHV0W25hbWU9J2xpbmtfdG8nXVwiKSk7XG4gICAgdmFyIGltYWdlVGFnID0gYmFubmVySXRlbS5maW5kKFwiLnRodW1ibmFpbFwiKTtcbiAgICB2YXIgYmFubmVySWQgPSBiYW5uZXJJdGVtLmF0dHIoJ2RhdGEtYmFubmVyLWlkJyk7XG4gICAgdmFyIHVybD0nJztcbiAgICBpZihiYW5uZXJJZCl7XG4gICAgICAgIHVybD0nL2Ntcy9lZGl0X2Jhbm5lci8nXG4gICAgfWVsc2V7XG4gICAgICAgIHVybD0nL2Ntcy9hZGRfYmFubmVyLydcbiAgICB9XG5cbiAgICBzYXZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGltZ191cmwgPSBpbWFnZVRhZy5hdHRyKCdzcmMnKTtcbiAgICAgICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdHlUYWcudmFsKCk7XG4gICAgICAgIHZhciBsaW5rX3RvID0gbGlua190b1RhZy52YWwoKTtcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOnVybCxcbiAgICAgICAgICAgICdkYXRhJzp7XG4gICAgICAgICAgICAgICAgJ2ltZ191cmwnOmltZ191cmwsXG4gICAgICAgICAgICAgICAgJ3ByaW9yaXR5Jzpwcmlvcml0eSxcbiAgICAgICAgICAgICAgICAnbGlua190byc6bGlua190b1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ109PT0yMDApe1xuICAgICAgICAgICAgICAgICAgICBiYW5uZXJJZCA9IHJlc3VsdFsnZGF0YSddWydiYW5uZXJfaWQnXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnLGJhbm5lcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfova7mkq3lm77mt7vliqDlrozmiJDvvIEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn07XG5cblxuQmFubmVycy5wcm90b3R5cGUuYWRkSW1hZ2VTZWxlY3RFdmVudCA9IGZ1bmN0aW9uIChiYW5uZXJJdGVtKSB7XG4gICAgdmFyIGltYWdlID0gYmFubmVySXRlbS5maW5kKCcudGh1bWJuYWlsJyk7XG4gICAgdmFyIGltYWdlSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoJy5pbWFnZS1pbnB1dCcpO1xuICAgIC8vIOWbvueJh+aYr+S4jeiDveWkn+aJk+W8gOaWh+S7tumAieaLqeahhueahO+8jOWPquiDvemAmui/h2lucHV0W3R5cGU9J2ZpbGUnXVxuICAgIGltYWdlLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW1hZ2VJbnB1dC5jbGljaygpO1xuICAgIH0pO1xuXG4gICAgaW1hZ2VJbnB1dC5jaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmlsZSA9IHRoaXMuZmlsZXNbMF07XG4gICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoXCJmaWxlXCIsZmlsZSk7XG4gICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAndXJsJzogJy9jbXMvdXBsb2FkX2ZpbGUvJyxcbiAgICAgICAgICAgICdkYXRhJzogZm9ybURhdGEsXG4gICAgICAgICAgICAncHJvY2Vzc0RhdGEnOiBmYWxzZSxcbiAgICAgICAgICAgICdjb250ZW50VHlwZSc6IGZhbHNlLFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXN1bHRbJ2RhdGEnXVsndXJsJ107XG4gICAgICAgICAgICAgICAgICAgIGltYWdlLmF0dHIoJ3NyYycsdXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRSZW1vdmVCdG4gPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcbiAgICB2YXIgcmVtb3ZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuYnRuLWNsb3NlJyk7XG4gICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xuICAgIHJlbW92ZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmKGJhbm5lcklkKVxuICAgICAgICB7XG4gICAgICAgICAgICB4ZnphbGVydC5hbGVydENvbmZpcm0oe1xuICAgICAgICAgICAgICAgICd0ZXh0Jzon56Gu5a6a6KaB5Yig6Zmk5ZCXJyxcbiAgICAgICAgICAgICAgICAnY29uZmlybUNhbGxiYWNrJzpmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAndXJsJzonL2Ntcy9kZWxldGVfYmFubmVyLycsXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc6e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdiYW5uZXJfaWQnOmJhbm5lcklkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXT09PTIwMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfova7mkq3lm77liKDpmaTmiJDlip8nKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIGVsc2VcbiAgICAgICAge1xuICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0pXG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5SdW4gPWZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICBzZWxmLmxpc3RlbkJhbm5lcnNBZGRCdG4oKTtcbiAgICBzZWxmLkxvYWREYXRhKCk7XG59O1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYmFubmVycyA9bmV3IEJhbm5lcnMoKTtcbiAgICBiYW5uZXJzLlJ1bigpXG59KTsiXX0=
