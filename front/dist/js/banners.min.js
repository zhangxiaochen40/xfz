function Banners(){}Banners.prototype.LoadData=function(){var s=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,a=0;a<e.length;a++){var t=e[a],r=template("banner-item",{banner:t}),i=$(".banner-list-group");i.append(r);var o=i.find(".banner-item:last");s.addImageSelectEvent(o),s.addRemoveBtn(o),s.saveBannerEvent(o)}else console.log("cuowu")}})},Banners.prototype.listenBannersAddBtn=function(){var t=this;$("#banner-add-btn").click(function(){var n=template("banner-item"),e=$(".banner-list-group");e.prepend(n);var a=e.find(".banner-item:first");t.addImageSelectEvent(a),t.addRemoveBtn(a),t.saveBannerEvent(a)})},Banners.prototype.saveBannerEvent=function(t){var n=t.find(".btn-save"),r=t.find("input[name='priority']"),i=t.find("input[name='link_to']"),o=t.find(".thumbnail");n.click(function(){var n=o.attr("src"),e=r.val(),a=i.val();xfzajax.post({url:"/cms/add_banner/",data:{img_url:n,priority:e,link_to:a},success:function(n){200===n.code&&(console.log("1111"),bannerId=n.data.banner_id,t.attr("data-banner-id",bannerId),window.messageBox.showSuccess("轮播图添加完成！"))}})})},Banners.prototype.addImageSelectEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.addRemoveBtn=function(e){var n=e.find(".btn-close"),a=e.attr("data-banner-id");n.click(function(){a?xfzalert.alertConfirm({text:"确定要删除吗",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:a},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功"))}})}}):e.remove()})},Banners.prototype.Run=function(){this.listenBannersAddBtn(),this.LoadData()},$(function(){(new Banners).Run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsIkxvYWREYXRhIiwic2VsZiIsInRoaXMiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImJhbm5lcnMiLCJpIiwibGVuZ3RoIiwiYmFubmVyIiwidHBsIiwidGVtcGxhdGUiLCJiYW5uZXJHcm91cCIsIiQiLCJhcHBlbmQiLCJiYW5uZXJJdGVtIiwiZmluZCIsImFkZEltYWdlU2VsZWN0RXZlbnQiLCJhZGRSZW1vdmVCdG4iLCJzYXZlQmFubmVyRXZlbnQiLCJjb25zb2xlIiwibG9nIiwibGlzdGVuQmFubmVyc0FkZEJ0biIsImNsaWNrIiwicHJlcGVuZCIsInNhdmVCdG4iLCJwcmlvcml0eVRhZyIsImxpbmtfdG9UYWciLCJpbWFnZVRhZyIsImltZ191cmwiLCJhdHRyIiwicHJpb3JpdHkiLCJ2YWwiLCJsaW5rX3RvIiwicG9zdCIsImRhdGEiLCJiYW5uZXJJZCIsIndpbmRvdyIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImltYWdlIiwiaW1hZ2VJbnB1dCIsImNoYW5nZSIsImZpbGUiLCJmaWxlcyIsImZvcm1EYXRhIiwiRm9ybURhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwicmVtb3ZlQnRuIiwieGZ6YWxlcnQiLCJhbGVydENvbmZpcm0iLCJ0ZXh0IiwiY29uZmlybUNhbGxiYWNrIiwiYmFubmVyX2lkIiwicmVtb3ZlIiwiUnVuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxXQUtUQSxRQUFRQyxVQUFVQyxTQUFXLFdBQ3pCLElBQUlDLEVBQU1DLEtBQ1ZDLFFBQVFDLElBQUksQ0FDUkMsSUFBTSxvQkFDTkMsUUFBVSxTQUFVQyxHQUNoQixHQUFvQixNQUFqQkEsRUFBYSxLQUVaLElBREQsSUFBSUMsRUFBVUQsRUFBYSxLQUNqQkUsRUFBRSxFQUFFQSxFQUFFRCxFQUFRRSxPQUFPRCxJQUFJLENBQzlCLElBQUlFLEVBQVNILEVBQVFDLEdBQ2pCRyxFQUFNQyxTQUFTLGNBQWMsQ0FBQ0YsT0FBU0EsSUFDdkNHLEVBQVlDLEVBQUUsc0JBQ2xCRCxFQUFZRSxPQUFPSixHQUVuQixJQUFJSyxFQUFhSCxFQUFZSSxLQUFLLHFCQUVsQ2pCLEVBQUtrQixvQkFBb0JGLEdBQ3pCaEIsRUFBS21CLGFBQWFILEdBQ2xCaEIsRUFBS29CLGdCQUFnQkosUUFJekJLLFFBQVFDLElBQUksYUFPNUJ6QixRQUFRQyxVQUFVeUIsb0JBQXFCLFdBQ25DLElBQUl2QixFQUFPQyxLQUNJYSxFQUFFLG1CQUNQVSxNQUFNLFdBQ1osSUFBSWIsRUFBS0MsU0FBUyxlQUNkQyxFQUFZQyxFQUFFLHNCQUNsQkQsRUFBWVksUUFBUWQsR0FFcEIsSUFBSUssRUFBYUgsRUFBWUksS0FBSyxzQkFFbENqQixFQUFLa0Isb0JBQW9CRixHQUN6QmhCLEVBQUttQixhQUFhSCxHQUNsQmhCLEVBQUtvQixnQkFBZ0JKLE1BSzdCbkIsUUFBUUMsVUFBVXNCLGdCQUFrQixTQUFTSixHQUN6QyxJQUFJVSxFQUFVVixFQUFXQyxLQUFLLGFBQzFCVSxFQUFjWCxFQUFXQyxLQUFLLDBCQUM5QlcsRUFBYVosRUFBV0MsS0FBSyx5QkFDN0JZLEVBQVdiLEVBQVdDLEtBQUssY0FFL0JTLEVBQVFGLE1BQU0sV0FDVixJQUFJTSxFQUFVRCxFQUFTRSxLQUFLLE9BQ3hCQyxFQUFXTCxFQUFZTSxNQUN2QkMsRUFBVU4sRUFBV0ssTUFDekIvQixRQUFRaUMsS0FBSyxDQUNUL0IsSUFBTSxtQkFDTmdDLEtBQU8sQ0FDSE4sUUFBVUEsRUFDVkUsU0FBV0EsRUFDWEUsUUFBVUEsR0FFZDdCLFFBQVUsU0FBVUMsR0FDSSxNQUFqQkEsRUFBYSxPQUNaZSxRQUFRQyxJQUFJLFFBQ1plLFNBQVcvQixFQUFhLEtBQWEsVUFDakNVLEVBQVdlLEtBQUssaUJBQWlCTSxVQUNqQ0MsT0FBT0MsV0FBV0MsWUFBWSxtQkFRdEQzQyxRQUFRQyxVQUFVb0Isb0JBQXNCLFNBQVVGLEdBQzlDLElBQUl5QixFQUFRekIsRUFBV0MsS0FBSyxjQUN4QnlCLEVBQWExQixFQUFXQyxLQUFLLGdCQUVqQ3dCLEVBQU1qQixNQUFNLFdBQ1JrQixFQUFXbEIsVUFHZmtCLEVBQVdDLE9BQU8sV0FDZCxJQUFJQyxFQUFPM0MsS0FBSzRDLE1BQU0sR0FDbEJDLEVBQVcsSUFBSUMsU0FDbkJELEVBQVMvQixPQUFPLE9BQU82QixHQUN2QjFDLFFBQVFpQyxLQUFLLENBQ1QvQixJQUFPLG9CQUNQZ0MsS0FBUVUsRUFDUkUsYUFBZSxFQUNmQyxhQUFlLEVBQ2Y1QyxRQUFXLFNBQVVDLEdBQ2pCLEdBQXNCLE1BQW5CQSxFQUFhLEtBQVUsQ0FDdEIsSUFBSUYsRUFBTUUsRUFBYSxLQUFPLElBQzlCbUMsRUFBTVYsS0FBSyxNQUFNM0IsVUFRckNQLFFBQVFDLFVBQVVxQixhQUFlLFNBQVNILEdBQ3RDLElBQUlrQyxFQUFZbEMsRUFBV0MsS0FBSyxjQUM1Qm9CLEVBQVdyQixFQUFXZSxLQUFLLGtCQUMvQm1CLEVBQVUxQixNQUFNLFdBQ1RhLEVBRUNjLFNBQVNDLGFBQWEsQ0FDbEJDLEtBQU8sU0FDUEMsZ0JBQWtCLFdBQ2RwRCxRQUFRaUMsS0FBSyxDQUNUL0IsSUFBTSxzQkFDTmdDLEtBQU8sQ0FDSG1CLFVBQVlsQixHQUVoQmhDLFFBQVUsU0FBVUMsR0FDSSxNQUFqQkEsRUFBYSxPQUNaVSxFQUFXd0MsU0FDWGxCLE9BQU9DLFdBQVdDLFlBQVksa0JBU2xEeEIsRUFBV3dDLFlBTXZCM0QsUUFBUUMsVUFBVTJELElBQUssV0FDVHhELEtBQ0xzQixzQkFES3RCLEtBRUxGLFlBR1RlLEVBQUUsWUFDZSxJQUFJakIsU0FDVDREIiwiZmlsZSI6ImJhbm5lcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQmFubmVycygpIHtcblxufVxuXG5cbkJhbm5lcnMucHJvdG90eXBlLkxvYWREYXRhID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB4ZnphamF4LmdldCh7XG4gICAgICAgICd1cmwnOicvY21zL2Jhbm5lcl9saXN0LycsXG4gICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXT09PTIwMCl7XG4gICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGk9MDtpPGJhbm5lcnMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXIgPSBiYW5uZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoJ2Jhbm5lci1pdGVtJyx7J2Jhbm5lcic6YmFubmVyfSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXJHcm91cD0kKCcuYmFubmVyLWxpc3QtZ3JvdXAnKTtcbiAgICAgICAgICAgICAgICAgICAgYmFubmVyR3JvdXAuYXBwZW5kKHRwbCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhbm5lckl0ZW0gPSBiYW5uZXJHcm91cC5maW5kKCcuYmFubmVyLWl0ZW06bGFzdCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRSZW1vdmVCdG4oYmFubmVySXRlbSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1lbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2N1b3d1JylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5cbkJhbm5lcnMucHJvdG90eXBlLmxpc3RlbkJhbm5lcnNBZGRCdG4gPWZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBiYW5uZXJCdG4gPSQoJyNiYW5uZXItYWRkLWJ0bicpO1xuICAgIGJhbm5lckJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0cGwgPXRlbXBsYXRlKCdiYW5uZXItaXRlbScpO1xuICAgICAgICB2YXIgYmFubmVyR3JvdXA9JCgnLmJhbm5lci1saXN0LWdyb3VwJyk7XG4gICAgICAgIGJhbm5lckdyb3VwLnByZXBlbmQodHBsKTtcblxuICAgICAgICB2YXIgYmFubmVySXRlbSA9IGJhbm5lckdyb3VwLmZpbmQoJy5iYW5uZXItaXRlbTpmaXJzdCcpO1xuXG4gICAgICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICAgICAgc2VsZi5hZGRSZW1vdmVCdG4oYmFubmVySXRlbSk7XG4gICAgICAgIHNlbGYuc2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xuICAgIH0pXG59O1xuXG5cbkJhbm5lcnMucHJvdG90eXBlLnNhdmVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xuICAgIHZhciBzYXZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuYnRuLXNhdmUnKTtcbiAgICB2YXIgcHJpb3JpdHlUYWcgPSBiYW5uZXJJdGVtLmZpbmQoXCJpbnB1dFtuYW1lPSdwcmlvcml0eSddXCIpO1xuICAgIHZhciBsaW5rX3RvVGFnID0gYmFubmVySXRlbS5maW5kKChcImlucHV0W25hbWU9J2xpbmtfdG8nXVwiKSk7XG4gICAgdmFyIGltYWdlVGFnID0gYmFubmVySXRlbS5maW5kKFwiLnRodW1ibmFpbFwiKTtcblxuICAgIHNhdmVCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW1nX3VybCA9IGltYWdlVGFnLmF0dHIoJ3NyYycpO1xuICAgICAgICB2YXIgcHJpb3JpdHkgPSBwcmlvcml0eVRhZy52YWwoKTtcbiAgICAgICAgdmFyIGxpbmtfdG8gPSBsaW5rX3RvVGFnLnZhbCgpO1xuICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6Jy9jbXMvYWRkX2Jhbm5lci8nLFxuICAgICAgICAgICAgJ2RhdGEnOntcbiAgICAgICAgICAgICAgICAnaW1nX3VybCc6aW1nX3VybCxcbiAgICAgICAgICAgICAgICAncHJpb3JpdHknOnByaW9yaXR5LFxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzpsaW5rX3RvXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOmZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXT09PTIwMCl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCcxMTExJyk7XG4gICAgICAgICAgICAgICAgICAgIGJhbm5lcklkID0gcmVzdWx0WydkYXRhJ11bJ2Jhbm5lcl9pZCddO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcsYmFubmVySWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+i9ruaSreWbvua3u+WKoOWujOaIkO+8gScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KVxufTtcblxuXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRJbWFnZVNlbGVjdEV2ZW50ID0gZnVuY3Rpb24gKGJhbm5lckl0ZW0pIHtcbiAgICB2YXIgaW1hZ2UgPSBiYW5uZXJJdGVtLmZpbmQoJy50aHVtYm5haWwnKTtcbiAgICB2YXIgaW1hZ2VJbnB1dCA9IGJhbm5lckl0ZW0uZmluZCgnLmltYWdlLWlucHV0Jyk7XG4gICAgLy8g5Zu+54mH5piv5LiN6IO95aSf5omT5byA5paH5Lu26YCJ5oup5qGG55qE77yM5Y+q6IO96YCa6L+HaW5wdXRbdHlwZT0nZmlsZSddXG4gICAgaW1hZ2UuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpbWFnZUlucHV0LmNsaWNrKCk7XG4gICAgfSk7XG5cbiAgICBpbWFnZUlucHV0LmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcbiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZChcImZpbGVcIixmaWxlKTtcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiAnL2Ntcy91cGxvYWRfZmlsZS8nLFxuICAgICAgICAgICAgJ2RhdGEnOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICdwcm9jZXNzRGF0YSc6IGZhbHNlLFxuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzogZmFsc2UsXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UuYXR0cignc3JjJyx1cmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5cbkJhbm5lcnMucHJvdG90eXBlLmFkZFJlbW92ZUJ0biA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xuICAgIHZhciByZW1vdmVCdG4gPSBiYW5uZXJJdGVtLmZpbmQoJy5idG4tY2xvc2UnKTtcbiAgICB2YXIgYmFubmVySWQgPSBiYW5uZXJJdGVtLmF0dHIoJ2RhdGEtYmFubmVyLWlkJyk7XG4gICAgcmVtb3ZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYoYmFubmVySWQpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHhmemFsZXJ0LmFsZXJ0Q29uZmlybSh7XG4gICAgICAgICAgICAgICAgJ3RleHQnOifnoa7lrpropoHliKDpmaTlkJcnLFxuICAgICAgICAgICAgICAgICdjb25maXJtQ2FsbGJhY2snOmZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd1cmwnOicvY21zL2RlbGV0ZV9iYW5uZXIvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJzp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Jhbm5lcl9pZCc6YmFubmVySWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddPT09MjAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MoJ+i9ruaSreWbvuWIoOmZpOaIkOWKnycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSlcbn07XG5cbkJhbm5lcnMucHJvdG90eXBlLlJ1biA9ZnVuY3Rpb24gKCkge1xuICAgIHZhciBzZWxmID10aGlzO1xuICAgIHNlbGYubGlzdGVuQmFubmVyc0FkZEJ0bigpO1xuICAgIHNlbGYuTG9hZERhdGEoKTtcbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBiYW5uZXJzID1uZXcgQmFubmVycygpO1xuICAgIGJhbm5lcnMuUnVuKClcbn0pOyJdfQ==
