function Banners(){}Banners.prototype.listenBannersAddBtn=function(){var a=this;$("#banner-add-btn").click(function(){var n=template("banner-item"),e=$(".banner-list-group");e.prepend(n);var t=e.find(".banner-item:first");a.addImageSelectEvent(t),a.addRemoveBtn(t),a.saveBannerEvent(t)})},Banners.prototype.saveBannerEvent=function(a){var n=a.find(".btn-save"),i=a.find("input[name='priority']"),o=a.find("input[name='link_to']"),r=a.find(".thumbnail");n.click(function(){var n=r.attr("src"),e=i.val(),t=o.val();xfzajax.post({url:"/cms/add_banner/",data:{img_url:n,priority:e,link_to:t},success:function(n){200===n.code&&(console.log("1111"),bannerId=n.data.banner_id,a.attr("data-banner-id",bannerId),window.messageBox.showSuccess("轮播图添加完成！"))}})})},Banners.prototype.addImageSelectEvent=function(n){var t=n.find(".thumbnail"),e=n.find(".image-input");console.log("123123123"),t.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;console.log(e),t.attr("src",e)}}})})},Banners.prototype.addRemoveBtn=function(n){n.find(".btn-close").click(function(){n.remove()})},Banners.prototype.Run=function(){this.listenBannersAddBtn()},$(function(){(new Banners).Run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsImxpc3RlbkJhbm5lcnNBZGRCdG4iLCJzZWxmIiwidGhpcyIsIiQiLCJjbGljayIsInRwbCIsInRlbXBsYXRlIiwiYmFubmVyR3JvdXAiLCJwcmVwZW5kIiwiYmFubmVySXRlbSIsImZpbmQiLCJhZGRJbWFnZVNlbGVjdEV2ZW50IiwiYWRkUmVtb3ZlQnRuIiwic2F2ZUJhbm5lckV2ZW50Iiwic2F2ZUJ0biIsInByaW9yaXR5VGFnIiwibGlua190b1RhZyIsImltYWdlVGFnIiwiaW1nX3VybCIsImF0dHIiLCJwcmlvcml0eSIsInZhbCIsImxpbmtfdG8iLCJ4ZnphamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0IiwiY29uc29sZSIsImxvZyIsImJhbm5lcklkIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dTdWNjZXNzIiwiaW1hZ2UiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJyZW1vdmUiLCJSdW4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLFdBSVRBLFFBQVFDLFVBQVVDLG9CQUFxQixXQUNuQyxJQUFJQyxFQUFPQyxLQUNJQyxFQUFFLG1CQUNQQyxNQUFNLFdBQ1osSUFBSUMsRUFBS0MsU0FBUyxlQUNkQyxFQUFZSixFQUFFLHNCQUNsQkksRUFBWUMsUUFBUUgsR0FFcEIsSUFBSUksRUFBYUYsRUFBWUcsS0FBSyxzQkFFbENULEVBQUtVLG9CQUFvQkYsR0FDekJSLEVBQUtXLGFBQWFILEdBQ2xCUixFQUFLWSxnQkFBZ0JKLE1BSzdCWCxRQUFRQyxVQUFVYyxnQkFBa0IsU0FBU0osR0FDekMsSUFBSUssRUFBVUwsRUFBV0MsS0FBSyxhQUMxQkssRUFBY04sRUFBV0MsS0FBSywwQkFDOUJNLEVBQWFQLEVBQVdDLEtBQUsseUJBQzdCTyxFQUFXUixFQUFXQyxLQUFLLGNBRS9CSSxFQUFRVixNQUFNLFdBQ1YsSUFBSWMsRUFBVUQsRUFBU0UsS0FBSyxPQUN4QkMsRUFBV0wsRUFBWU0sTUFDdkJDLEVBQVVOLEVBQVdLLE1BQ3pCRSxRQUFRQyxLQUFLLENBQ1RDLElBQU0sbUJBQ05DLEtBQU8sQ0FDSFIsUUFBVUEsRUFDVkUsU0FBV0EsRUFDWEUsUUFBVUEsR0FFZEssUUFBVSxTQUFVQyxHQUNJLE1BQWpCQSxFQUFhLE9BQ1pDLFFBQVFDLElBQUksUUFDWkMsU0FBV0gsRUFBYSxLQUFhLFVBQ2pDbkIsRUFBV1UsS0FBSyxpQkFBaUJZLFVBQ2pDQyxPQUFPQyxXQUFXQyxZQUFZLG1CQVF0RHBDLFFBQVFDLFVBQVVZLG9CQUFzQixTQUFVRixHQUM5QyxJQUFJMEIsRUFBUTFCLEVBQVdDLEtBQUssY0FDeEIwQixFQUFhM0IsRUFBV0MsS0FBSyxnQkFFakNtQixRQUFRQyxJQUFJLGFBQ1pLLEVBQU0vQixNQUFNLFdBQ1JnQyxFQUFXaEMsVUFHZmdDLEVBQVdDLE9BQU8sV0FDZCxJQUFJQyxFQUFPcEMsS0FBS3FDLE1BQU0sR0FDbEJDLEVBQVcsSUFBSUMsU0FDbkJELEVBQVNFLE9BQU8sT0FBT0osR0FDdkJmLFFBQVFDLEtBQUssQ0FDVEMsSUFBTyxvQkFDUEMsS0FBUWMsRUFDUkcsYUFBZSxFQUNmQyxhQUFlLEVBQ2ZqQixRQUFXLFNBQVVDLEdBQ2pCLEdBQXNCLE1BQW5CQSxFQUFhLEtBQVUsQ0FDdEIsSUFBSUgsRUFBTUcsRUFBYSxLQUFPLElBQzlCQyxRQUFRQyxJQUFJTCxHQUNaVSxFQUFNaEIsS0FBSyxNQUFNTSxVQVFyQzNCLFFBQVFDLFVBQVVhLGFBQWUsU0FBU0gsR0FDdEJBLEVBQVdDLEtBQUssY0FDdEJOLE1BQU0sV0FDWkssRUFBV29DLFlBSW5CL0MsUUFBUUMsVUFBVStDLElBQUssV0FDVDVDLEtBQ0xGLHVCQUdURyxFQUFFLFlBQ2UsSUFBSUwsU0FDVGdEIiwiZmlsZSI6ImJhbm5lcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gQmFubmVycygpIHtcblxufVxuXG5CYW5uZXJzLnByb3RvdHlwZS5saXN0ZW5CYW5uZXJzQWRkQnRuID1mdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgYmFubmVyQnRuID0kKCcjYmFubmVyLWFkZC1idG4nKTtcbiAgICBiYW5uZXJCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdHBsID10ZW1wbGF0ZSgnYmFubmVyLWl0ZW0nKTtcbiAgICAgICAgdmFyIGJhbm5lckdyb3VwPSQoJy5iYW5uZXItbGlzdC1ncm91cCcpO1xuICAgICAgICBiYW5uZXJHcm91cC5wcmVwZW5kKHRwbCk7XG5cbiAgICAgICAgdmFyIGJhbm5lckl0ZW0gPSBiYW5uZXJHcm91cC5maW5kKCcuYmFubmVyLWl0ZW06Zmlyc3QnKTtcblxuICAgICAgICBzZWxmLmFkZEltYWdlU2VsZWN0RXZlbnQoYmFubmVySXRlbSk7XG4gICAgICAgIHNlbGYuYWRkUmVtb3ZlQnRuKGJhbm5lckl0ZW0pO1xuICAgICAgICBzZWxmLnNhdmVCYW5uZXJFdmVudChiYW5uZXJJdGVtKTtcbiAgICB9KVxufTtcblxuXG5CYW5uZXJzLnByb3RvdHlwZS5zYXZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcbiAgICB2YXIgc2F2ZUJ0biA9IGJhbm5lckl0ZW0uZmluZCgnLmJ0bi1zYXZlJyk7XG4gICAgdmFyIHByaW9yaXR5VGFnID0gYmFubmVySXRlbS5maW5kKFwiaW5wdXRbbmFtZT0ncHJpb3JpdHknXVwiKTtcbiAgICB2YXIgbGlua190b1RhZyA9IGJhbm5lckl0ZW0uZmluZCgoXCJpbnB1dFtuYW1lPSdsaW5rX3RvJ11cIikpO1xuICAgIHZhciBpbWFnZVRhZyA9IGJhbm5lckl0ZW0uZmluZChcIi50aHVtYm5haWxcIik7XG5cbiAgICBzYXZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGltZ191cmwgPSBpbWFnZVRhZy5hdHRyKCdzcmMnKTtcbiAgICAgICAgdmFyIHByaW9yaXR5ID0gcHJpb3JpdHlUYWcudmFsKCk7XG4gICAgICAgIHZhciBsaW5rX3RvID0gbGlua190b1RhZy52YWwoKTtcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOicvY21zL2FkZF9iYW5uZXIvJyxcbiAgICAgICAgICAgICdkYXRhJzp7XG4gICAgICAgICAgICAgICAgJ2ltZ191cmwnOmltZ191cmwsXG4gICAgICAgICAgICAgICAgJ3ByaW9yaXR5Jzpwcmlvcml0eSxcbiAgICAgICAgICAgICAgICAnbGlua190byc6bGlua190b1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzpmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ109PT0yMDApe1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnMTExMScpO1xuICAgICAgICAgICAgICAgICAgICBiYW5uZXJJZCA9IHJlc3VsdFsnZGF0YSddWydiYW5uZXJfaWQnXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0uYXR0cignZGF0YS1iYW5uZXItaWQnLGJhbm5lcklkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKCfova7mkq3lm77mt7vliqDlrozmiJDvvIEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcbn07XG5cblxuQmFubmVycy5wcm90b3R5cGUuYWRkSW1hZ2VTZWxlY3RFdmVudCA9IGZ1bmN0aW9uIChiYW5uZXJJdGVtKSB7XG4gICAgdmFyIGltYWdlID0gYmFubmVySXRlbS5maW5kKCcudGh1bWJuYWlsJyk7XG4gICAgdmFyIGltYWdlSW5wdXQgPSBiYW5uZXJJdGVtLmZpbmQoJy5pbWFnZS1pbnB1dCcpO1xuICAgIC8vIOWbvueJh+aYr+S4jeiDveWkn+aJk+W8gOaWh+S7tumAieaLqeahhueahO+8jOWPquiDvemAmui/h2lucHV0W3R5cGU9J2ZpbGUnXVxuICAgIGNvbnNvbGUubG9nKCcxMjMxMjMxMjMnKTtcbiAgICBpbWFnZS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGltYWdlSW5wdXQuY2xpY2soKTtcbiAgICB9KTtcblxuICAgIGltYWdlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdO1xuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKFwiZmlsZVwiLGZpbGUpO1xuICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvY21zL3VwbG9hZF9maWxlLycsXG4gICAgICAgICAgICAnZGF0YSc6IGZvcm1EYXRhLFxuICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXG4gICAgICAgICAgICAnY29udGVudFR5cGUnOiBmYWxzZSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gcmVzdWx0WydkYXRhJ11bJ3VybCddO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1cmwpXG4gICAgICAgICAgICAgICAgICAgIGltYWdlLmF0dHIoJ3NyYycsdXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRSZW1vdmVCdG4gPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcbiAgICB2YXIgcmVtb3ZlQnRuID0gYmFubmVySXRlbS5maW5kKCcuYnRuLWNsb3NlJyk7XG4gICAgcmVtb3ZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgYmFubmVySXRlbS5yZW1vdmUoKVxuICAgIH0pXG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5SdW4gPWZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICBzZWxmLmxpc3RlbkJhbm5lcnNBZGRCdG4oKTtcbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBiYW5uZXJzID1uZXcgQmFubmVycygpO1xuICAgIGJhbm5lcnMuUnVuKClcbn0pOyJdfQ==
