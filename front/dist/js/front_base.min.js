function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper")}FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},FrontBase.prototype.Run=function(){this.listenAuthBoxHover()},$(function(){(new FrontBase).Run()}),$(function(){$(".switch").click(function(){var t=$(".scroll-wrapper");parseInt(t.css("left"))<0?t.animate({left:"0"}):t.animate({left:"-400px"})})}),Auth.prototype.run=function(){var t=this;t.listenShowhideEvent(),t.listenSignInEvent(),t.ListCaptchaClick(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.ListCaptchaClick=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random"+Math.random())})},Auth.prototype.listenShowhideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),a=$(".close-btn"),s=$(".scroll-wrapper");n.click(function(){t.showEvent(),s.css({left:0})}),e.click(function(){t.showEvent(),s.css({left:-400})}),a.click(function(){t.hideEvent()})},Auth.prototype.SmsSuccessEvent=function(){var t=this,n=$(".sms-captcha-addon");messageBox.showSuccess("短信验证码发送成功"),n.addClass("disabled");var e=60;n.unbind("click");var a=setInterval(function(){n.text(e+"s"),--e<=0&&(clearInterval(a),n.removeClass("disabled"),n.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSignupEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){t.preventDefault();var n=f.find("input[name='telephone']"),e=f.find("input[name='username']"),a=f.find("input[name='img_captcha']"),s=f.find("input[name='password1']"),o=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),u=a.val(),p=s.val(),l=o.val(),h=i.val();xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:u,password1:p,password2:l,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,t=$(".sms-captcha-addon"),e=$(".signup-group input[name='telephone']");t.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.SmsSuccessEvent()},fail:function(t){console.log(t)}})})},Auth.prototype.listenSignInEvent=function(){var s=this,t=$(".signin-group"),a=t.find("input[name='telephone']"),o=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=a.val(),n=o.val(),e=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){if(200==t.code)s.hideEvent(),window.location.reload();else{var n=t.message;if("string"==typeof n||n.constructor==String)window.messageBox.show(n);else for(var e in n){var a=n[e][0];window.messageBox.show(a)}}},fail:function(t){console.log(t)}})})},$(function(){(new Auth).run()}),$(function(){template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),a=((new Date).getTime()-e)/1e3;return a<60?"刚刚":60<=a&&a<3600?(minutes=parseInt(a/60),minutes+"分钟前"):3600<=a&&a<86400?(hours=parseInt(a/60/60),hours+"小时前"):86400<=a&&a<2592e3?(days=parseInt(a/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInRoaXMiLCJtYXNrV3JhcHBlciIsIiQiLCJwcm90b3R5cGUiLCJsaXN0ZW5BdXRoQm94SG92ZXIiLCJhdXRoQm94IiwidXNlck1vcmVCb3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwiUnVuIiwiY2xpY2siLCJzY3JvbGxXcmFwcGVyIiwicGFyc2VJbnQiLCJjc3MiLCJhbmltYXRlIiwibGVmdCIsInJ1biIsInNlbGYiLCJsaXN0ZW5TaG93aGlkZUV2ZW50IiwibGlzdGVuU2lnbkluRXZlbnQiLCJMaXN0Q2FwdGNoYUNsaWNrIiwibGlzdGVuU21zQ2FwdGNoYUV2ZW50IiwibGlzdGVuU2lnbnVwRXZlbnQiLCJzaG93RXZlbnQiLCJoaWRlRXZlbnQiLCJpbWciLCJhdHRyIiwiTWF0aCIsInJhbmRvbSIsInNpZ25pbkJ0biIsInNpZ251cEJ0biIsImNsb3NlQnRuIiwiU21zU3VjY2Vzc0V2ZW50Iiwic21zQ2FwdGNoYSIsIm1lc3NhZ2VCb3giLCJzaG93U3VjY2VzcyIsImFkZENsYXNzIiwiY291bnQiLCJ1bmJpbmQiLCJ0aW1lIiwic2V0SW50ZXJ2YWwiLCJ0ZXh0IiwiY2xlYXJJbnRlcnZhbCIsInJlbW92ZUNsYXNzIiwic2lnbnVwR3JvdXAiLCJmaW5kIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRlbGVwaG9uZUlucHV0IiwidXNlcm5hbWVJbnB1dCIsImltZ0NhcHRjaGFJbnB1dCIsInBhc3N3b3JkMUlucHV0IiwicGFzc3dvcmQySW5wdXQiLCJzbXNDYXB0Y2hhSW5wdXQiLCJ0ZWxlcGhvbmUiLCJ2YWwiLCJ1c2VybmFtZSIsImltZ19jYXB0Y2hhIiwicGFzc3dvcmQxIiwicGFzc3dvcmQyIiwic21zX2NhcHRjaGEiLCJ4ZnphamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJ0ZWxlUGhvbmVJbnB1dCIsInRlbGUiLCJzaG93SW5mbyIsImdldCIsImZhaWwiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJzaWduaW5ncm91cCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJ0ZWwiLCJwd2QiLCJyZW0iLCJwcm9wIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwia2V5IiwibWVzc2FnZSIsInRlbXBsYXRlIiwiZGVmYXVsdHMiLCJpbXBvcnRzIiwidGltZVNpbmNlIiwiZGF0ZVZhbHVlIiwiZGF0ZSIsIkRhdGUiLCJkYXRldHMiLCJnZXRUaW1lIiwidGltZXN0YW1wIiwibWludXRlcyIsImhvdXJzIiwiZGF5cyIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXkiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGFBMkNULFNBQVNDLE9BQ01DLEtBQ05DLFlBQWNDLEVBQUUsaUJBekN6QkosVUFBVUssVUFBVUMsbUJBQW1CLFdBQ25DLElBQUlDLEVBQVVILEVBQUUsYUFDWkksRUFBY0osRUFBRSxrQkFDcEJHLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDZCxXQUNFRixFQUFZRyxVQUtwQlgsVUFBVUssVUFBVU8sSUFBTSxXQUNiVixLQUNOSSxzQkFHUEYsRUFBRSxZQUNhLElBQUlKLFdBQ1ZZLFFBS1RSLEVBQUUsV0FDQ0EsRUFBRSxXQUFXUyxNQUFNLFdBQ2QsSUFBSUMsRUFBY1YsRUFBRSxtQkFDRlcsU0FBU0QsRUFBY0UsSUFBSSxTQUM5QixFQUVYRixFQUFjRyxRQUFRLENBQUNDLEtBQU8sTUFJOUJKLEVBQWNHLFFBQVEsQ0FBQ0MsS0FBTyxlQVcxQ2pCLEtBQUtJLFVBQVVjLElBQUksV0FDZixJQUFJQyxFQUFNbEIsS0FDVmtCLEVBQUtDLHNCQUNMRCxFQUFLRSxvQkFDTEYsRUFBS0csbUJBQ0xILEVBQUtJLHdCQUNMSixFQUFLSyxxQkFHVHhCLEtBQUtJLFVBQVVxQixVQUFVLFdBQ1h4QixLQUNMQyxZQUFZ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a0JBQ1BDLEtBQVEsQ0FDSlYsVUFBYTJCLEVBQ2JGLFNBQVlHLEVBQ1pGLFNBQVlHLEVBQUksRUFBRSxHQUV0QmxCLFFBQVcsU0FBVUMsR0FDaEIsR0FBcUIsS0FBbEJBLEVBQWEsS0FDYmpELEVBQUtPLFlBQ0wyQyxPQUFPQyxTQUFTQyxhQUNkLENBQ0QsSUFBSWdCLEVBQWdCbkIsRUFBZ0IsUUFDcEMsR0FBMkIsaUJBQWpCbUIsR0FBNkJBLEVBQWNDLGFBQWVDLE9BQ2pFcEIsT0FBT2pDLFdBQVczQixLQUFLOEUsUUFHdkIsSUFBSSxJQUFJRyxLQUFPSCxFQUFjLENBQ3pCLElBQ0lJLEVBRFdKLEVBQWNHLEdBQ04sR0FDdkJyQixPQUFPakMsV0FBVzNCLEtBQUtrRixNQU12Q2YsS0FBUSxTQUFVQyxHQUNkQyxRQUFRQyxJQUFJRixTQU81QjFFLEVBQUUsWUFDWSxJQUFJSCxNQUNWa0IsUUFJUmYsRUFBRSxXQUNLeUYsV0FDQ0EsU0FBU0MsU0FBU0MsUUFBUUMsVUFBWSxTQUFVQyxHQUM1QyxJQUFJQyxFQUFPLElBQUlDLEtBQUtGLEdBQ2hCRyxFQUFTRixFQUFLRyxVQUVkQyxJQURRLElBQUtILE1BQVFFLFVBQ0FELEdBQVEsSUFDakMsT0FBR0UsRUFBWSxHQUNKLEtBRVUsSUFBYkEsR0FBbUJBLEVBQVksTUFDbkNDLFFBQVV4RixTQUFTdUYsRUFBWSxJQUN4QkMsUUFBUSxPQUVFLE1BQWJELEdBQXNCQSxFQUFZLE9BQ3RDRSxNQUFRekYsU0FBU3VGLEVBQVksR0FBSyxJQUMzQkUsTUFBTSxPQUVJLE9BQWJGLEdBQXlCQSxFQUFZLFFBQ3pDRyxLQUFPMUYsU0FBU3VGLEVBQVksR0FBSyxHQUFLLElBQy9CRyxLQUFPLE1BRUhQLEVBQUtRLGNBS0osSUFKQVIsRUFBS1MsV0FJSyxJQUhaVCxFQUFLVSxTQUdlLElBRm5CVixFQUFLVyxXQUV1QixJQUQxQlgsRUFBS1kiLCJmaWxlIjoiZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBGcm9udEJhc2UoKSB7XG5cbn1cblxuRnJvbnRCYXNlLnByb3RvdHlwZS5saXN0ZW5BdXRoQm94SG92ZXI9ZnVuY3Rpb24gKCkge1xuICAgIHZhciBhdXRoQm94ID0gJCgnLmF1dGgtYm94Jyk7XG4gICAgdmFyIHVzZXJNb3JlQm94ID0gJCgnLnVzZXItbW9yZS1ib3gnKTtcbiAgICBhdXRoQm94LmhvdmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdXNlck1vcmVCb3guc2hvdygpXG4gICAgfSxmdW5jdGlvbiAoKSB7XG4gICAgICAgIHVzZXJNb3JlQm94LmhpZGUoKVxuICAgIH0pXG59O1xuXG5cbkZyb250QmFzZS5wcm90b3R5cGUuUnVuID0gZnVuY3Rpb24gKCkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHNlbGYubGlzdGVuQXV0aEJveEhvdmVyKCk7XG59O1xuXG4kKGZ1bmN0aW9uICgpIHtcbiAgIHZhciBmYmFzZSA9IG5ldyBGcm9udEJhc2UoKTtcbiAgIGZiYXNlLlJ1bigpO1xufSk7XG5cblxuXG4kKGZ1bmN0aW9uICgpIHtcbiAgICQoJy5zd2l0Y2gnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY3JvbGxXcmFwcGVyPSQoJy5zY3JvbGwtd3JhcHBlcicpO1xuICAgICAgICB2YXIgY3VycmVudGxlZnQgPSBwYXJzZUludChzY3JvbGxXcmFwcGVyLmNzcygnbGVmdCcpKTtcbiAgICAgICAgaWYoY3VycmVudGxlZnQ8MClcbiAgICAgICAge1xuICAgICAgICAgICAgc2Nyb2xsV3JhcHBlci5hbmltYXRlKHsnbGVmdCc6JzAnfSlcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7J2xlZnQnOictNDAwcHgnfSlcbiAgICAgICAgfVxuICAgfSlcbn0pO1xuXG5cbmZ1bmN0aW9uIEF1dGgoKSB7XG4gICAgdmFyICBzZWxmID10aGlzO1xuICAgIHNlbGYubWFza1dyYXBwZXIgPSAkKCcubWFzay13cmFwcGVyJylcbn1cblxuQXV0aC5wcm90b3R5cGUucnVuPWZ1bmN0aW9uKCl7XG4gICAgdmFyIHNlbGYgPXRoaXM7XG4gICAgc2VsZi5saXN0ZW5TaG93aGlkZUV2ZW50KCk7XG4gICAgc2VsZi5saXN0ZW5TaWduSW5FdmVudCgpO1xuICAgIHNlbGYuTGlzdENhcHRjaGFDbGljaygpO1xuICAgIHNlbGYubGlzdGVuU21zQ2FwdGNoYUV2ZW50KCk7XG4gICAgc2VsZi5saXN0ZW5TaWdudXBFdmVudCgpO1xufTtcblxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50PWZ1bmN0aW9uKCkge1xuICAgIHZhciBzZWxmID10aGlzO1xuICAgIHNlbGYubWFza1dyYXBwZXIuc2hvdygpO1xufTtcblxuQXV0aC5wcm90b3R5cGUuaGlkZUV2ZW50ID0gZnVuY3Rpb24oKXtcbiAgdmFyIHNlbGYgPXRoaXM7XG4gIHNlbGYubWFza1dyYXBwZXIuaGlkZSgpXG59O1xuXG5cbkF1dGgucHJvdG90eXBlLkxpc3RDYXB0Y2hhQ2xpY2s9ZnVuY3Rpb24oKXtcbiAgICB2YXIgaW1nID0kKCcuaW1nLWNhcHRjaGEnKTtcbiAgICBpbWcuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpbWcuYXR0cignc3JjJywnL2FjY291bnQvaW1nX2NhcHRjaGEvJysnP3JhbmRvbScrTWF0aC5yYW5kb20oKSlcbiAgICB9KTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNob3doaWRlRXZlbnQgPSBmdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID10aGlzO1xuICAgIHZhciBzaWduaW5CdG49JCgnLnNpZ25pbi1idG4nKTtcbiAgICB2YXIgc2lnbnVwQnRuPSQoJy5zaWdudXAtYnRuJyk7XG4gICAgdmFyIGNsb3NlQnRuPSQoJy5jbG9zZS1idG4nKTtcbiAgICB2YXIgc2Nyb2xsV3JhcHBlciA9ICQoJy5zY3JvbGwtd3JhcHBlcicpO1xuICAgIHNpZ25pbkJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuc2hvd0V2ZW50KCk7XG4gICAgICAgIHNjcm9sbFdyYXBwZXIuY3NzKHsnbGVmdCc6MH0pO1xuICAgIH0pO1xuXG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcbiAgICAgICAgc2Nyb2xsV3JhcHBlci5jc3MoeydsZWZ0JzotNDAwfSlcbiAgICB9KTtcblxuICAgIGNsb3NlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICBzZWxmLmhpZGVFdmVudCgpO1xuICAgIH0pO1xuXG59O1xuXG4vL+efreS/oemqjOivgeeggeWPkemAgeaIkOWKn+eahOS6i+S7tlxuQXV0aC5wcm90b3R5cGUuU21zU3VjY2Vzc0V2ZW50ID1mdW5jdGlvbigpe1xuICAgIHZhciBzZWxmID10aGlzO1xuICAgIHZhciBzbXNDYXB0Y2hhPSAkKCcuc21zLWNhcHRjaGEtYWRkb24nKTtcbiAgICBtZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5YqfXCIpO1xuICAgIHNtc0NhcHRjaGEuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgdmFyIGNvdW50PTYwO1xuICAgIHNtc0NhcHRjaGEudW5iaW5kKCdjbGljaycpO1xuICAgIHZhciB0aW1lID1zZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNtc0NhcHRjaGEudGV4dChjb3VudCsncycpO1xuICAgICAgICBjb3VudC0tO1xuICAgICAgICBpZihjb3VudDw9MCl7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWUpO1xuICAgICAgICAgICAgc21zQ2FwdGNoYS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHNtc0NhcHRjaGEudGV4dCgn5Y+R6YCB6aqM6K+B56CBJyk7XG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xuICAgICAgICB9XG4gICAgICAgIH0sMTAwMCk7XG59O1xuXG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzaWdudXBHcm91cCA9ICQoJy5zaWdudXAtZ3JvdXAnKTtcbiAgICB2YXIgc3VibWl0QnRuID0gc2lnbnVwR3JvdXAuZmluZCgnLnN1Ym1pdC1idG4nKTtcbiAgICBzdWJtaXRCdG4uY2xpY2soZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcbiAgICAgICAgdmFyIHVzZXJuYW1lSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndXNlcm5hbWUnXVwiKTtcbiAgICAgICAgdmFyIGltZ0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xuICAgICAgICB2YXIgcGFzc3dvcmQxSW5wdXQgPSBzaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQxJ11cIik7XG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDInXVwiKTtcbiAgICAgICAgdmFyIHNtc0NhcHRjaGFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xuXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIGltZ19jYXB0Y2hhID0gaW1nQ2FwdGNoYUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQxID0gcGFzc3dvcmQxSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHNtc19jYXB0Y2hhID0gc21zQ2FwdGNoYUlucHV0LnZhbCgpO1xuXG4gICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAndXJsJzogJy9hY2NvdW50L3JlZ2lzdGVyLycsXG4gICAgICAgICAgICAnZGF0YSc6IHtcbiAgICAgICAgICAgICAgICAndGVsZXBob25lJzogdGVsZXBob25lLFxuICAgICAgICAgICAgICAgICd1c2VybmFtZSc6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgICdpbWdfY2FwdGNoYSc6IGltZ19jYXB0Y2hhLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZDEnOiBwYXNzd29yZDEsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkMic6IHBhc3N3b3JkMixcbiAgICAgICAgICAgICAgICAnc21zX2NhcHRjaGEnOiBzbXNfY2FwdGNoYVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5cbi8v55uR5ZCs5Y+R6YCB55+t5L+h6aqM6K+B56CB55qE5LqL5Lu2XG5BdXRoLnByb3RvdHlwZS5saXN0ZW5TbXNDYXB0Y2hhRXZlbnQ9ZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB2YXIgc21zQ2FwdGNoYT0gJCgnLnNtcy1jYXB0Y2hhLWFkZG9uJyk7XG4gICAgdmFyIHRlbGVQaG9uZUlucHV0ID0gJChcIi5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XG4gICAgc21zQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ZWxlID10ZWxlUGhvbmVJbnB1dC52YWwoKTtcbiAgICAgICAgaWYoIXRlbGUpe1xuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbygn6K+36L6T5YWl5omL5py65Y+356CBJylcbiAgICAgICAgfVxuICAgICAgICB4ZnphamF4LmdldCh7XG4gICAgICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9zbXNfY2FwdGNoYS8nLFxuICAgICAgICAgICAgICAgICdkYXRhJzp7XG4gICAgICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOnRlbGVcbiAgICAgICAgICAgICAgICB9ICxcbiAgICAgICAgICAgICAgICAnc3VjY2Vzcyc6ZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXT09MjAwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuU21zU3VjY2Vzc0V2ZW50KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ2ZhaWwnOmZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcilcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICB9KTtcbn07XG5cblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbkluRXZlbnQ9ZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9dGhpcztcbiAgICB2YXIgc2lnbmluZ3JvdXAgPSAkKCcuc2lnbmluLWdyb3VwJyk7XG4gICAgdmFyIHRlbGVwaG9uZSA9IHNpZ25pbmdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd0ZWxlcGhvbmUnXVwiKTtcbiAgICB2YXIgcGFzc3dvcmQgPSBzaWduaW5ncm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncGFzc3dvcmQnXVwiKTtcbiAgICB2YXIgcmVtZW1iZXIgPSBzaWduaW5ncm91cC5maW5kKFwiaW5wdXRbbmFtZT0ncmVtZW1iZXInXVwiKTtcblxuICAgIHZhciBzdWJtaXRCdG49IHNpZ25pbmdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcblxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0ZWwgPSB0ZWxlcGhvbmUudmFsKCk7XG4gICAgICAgIHZhciBwd2QgPXBhc3N3b3JkLnZhbCgpO1xuICAgICAgICB2YXIgcmVtID0gcmVtZW1iZXIucHJvcCgnY2hlY2tlZCcpO1xuXG4gICAgICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9sb2dpbi8nLFxuICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbCxcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQnOiBwd2QsXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtPzE6MCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT0gMjAwKXtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0WydtZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgbWVzc2FnZU9iamVjdCA9PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09IFN0cmluZyl7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2VPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB7XCJwYXNzd29yZFwiOlsn5a+G56CB5pyA5aSn6ZW/5bqm5LiN6IO96LaF6L+HMjDkuLrvvIEnLCd4eHgnXSxcInRlbGVwaG9uZVwiOlsneHgnLCd4J119XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZXMgPSBtZXNzYWdlT2JqZWN0W2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBtZXNzYWdlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnZmFpbCc6IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSlcbn07XG5cblxuJChmdW5jdGlvbiAoKSB7XG4gICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XG4gICBhdXRoLnJ1bigpO1xufSk7XG5cblxuJChmdW5jdGlvbiAoKSB7XG4gICAgaWYodGVtcGxhdGUpe1xuICAgICAgICB0ZW1wbGF0ZS5kZWZhdWx0cy5pbXBvcnRzLnRpbWVTaW5jZSA9IGZ1bmN0aW9uIChkYXRlVmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcbiAgICAgICAgICAgIHZhciBkYXRldHMgPSBkYXRlLmdldFRpbWUoKTsgLy8g5b6X5Yiw55qE5piv5q+r56eS55qEXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpOyAvL+W+l+WIsOeahOaYr+W9k+WJjeaXtumXtOeahOaXtumXtOaIs1xuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IChub3d0cyAtIGRhdGV0cykvMTAwMDsgLy8g6Zmk5LulMTAwMO+8jOW+l+WIsOeahOaYr+enklxuICAgICAgICAgICAgaWYodGltZXN0YW1wIDwgNjApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ+WImuWImic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCkge1xuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1pbnV0ZXMrJ+WIhumSn+WJjSc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKHRpbWVzdGFtcCA+PSA2MCo2MCAmJiB0aW1lc3RhbXAgPCA2MCo2MCoyNCkge1xuICAgICAgICAgICAgICAgIGhvdXJzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzKyflsI/ml7bliY0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAqNjAqMjQgJiYgdGltZXN0YW1wIDwgNjAqNjAqMjQqMzApIHtcbiAgICAgICAgICAgICAgICBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCAvIDI0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF5cyArICflpKnliY0nO1xuICAgICAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICAgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xuICAgICAgICAgICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERheSgpO1xuICAgICAgICAgICAgICAgIHZhciBob3VyID0gZGF0ZS5nZXRIb3VycygpO1xuICAgICAgICAgICAgICAgIHZhciBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4geWVhcisnLycrbW9udGgrJy8nK2RheStcIiBcIitob3VyK1wiOlwiK21pbnV0ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pOyJdfQ==
